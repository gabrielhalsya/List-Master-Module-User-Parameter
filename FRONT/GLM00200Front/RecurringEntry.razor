@using GLM00200Common.DTO_s;
@using GLM00200Common;
@inherits R_Page
@attribute [R_Page(Title = "RecurringEntry")]

<R_GroupBox Title="Journal Description">
    <R_StackLayout Row>
        <R_ItemLayout xs="1">
            <R_Label>Department</R_Label>
        </R_ItemLayout>
        <R_ItemLayout xs="1">
            <R_TextBox bind-value="@_journalVM.Journal.CDEPT_CODE" R_EnableAdd></R_TextBox>
        </R_ItemLayout>
        <R_ItemLayout>
            <R_Lookup R_Before_Open_Lookup="Dept_Before_Open_Lookup" R_After_Open_Lookup="Dept_After_Open_Lookup">...</R_Lookup>
        </R_ItemLayout>
        <R_ItemLayout xs="1">
        </R_ItemLayout>
        <R_ItemLayout xs="1">
            <R_TextBox @bind-value="_journalVM._SearchParam.CDEPT_NAME" Enabled="false" CharacterCasing="R_eCharacterCasing.Upper" MaxLength="5"></R_TextBox>
        </R_ItemLayout>
        <R_ItemLayout xs="1">
            <R_Label>Currency*</R_Label>
        </R_ItemLayout>
        <R_ItemLayout xs="1">
            <R_ComboBox @bind-Value="@_journalVM.Journal.CCURRENCY_CODE"
                        Data="_journalVM._CURRENCY_LIST"
                        ValueField="@nameof(VAR_CURRENCY.CCURRENCY_CODE)"
                        TextField="@nameof(VAR_CURRENCY.CCURRENCY_NAME)"></R_ComboBox>
        </R_ItemLayout>
        <R_ItemLayout xs="2">
            <R_CheckBox bind-value="@_journalVM.Journal.LFIX_RATE" Enabled="ENABLE_LFIX_RATE" OnChanged="@LFIX_RATE_ONCHANGED"></R_CheckBox>
            <R_Label>Fixed Exchange Rate</R_Label>
        </R_ItemLayout>
        <R_ItemLayout xs="1">
        </R_ItemLayout>
        <R_ItemLayout xs="1">
            <R_Label>Prelist</R_Label>
        </R_ItemLayout>
        <R_ItemLayout xs="1">
            <R_TextBox bind-value="@_journalVM.Journal.NPRELIST_AMOUNT" Enabled="ENABLE_NPRELIST_AMOUNT"></R_TextBox>
        </R_ItemLayout>
    </R_StackLayout>
    <R_StackLayout Row>
        <R_ItemLayout xs="1">
            <R_Label>Reference No. *</R_Label>
        </R_ItemLayout>
        <R_ItemLayout xs="1">
            <R_TextBox bind-value="@_journalVM.Journal.CREF_NO" R_EnableAdd" MaxLength="30"></R_TextBox>
        </R_ItemLayout>
        <R_ItemLayout xs="1">
            <R_Label>Ref Date. *</R_Label>
        </R_ItemLayout>
        <R_ItemLayout xs="1">
            <R_DateTimePicker @bind-Value="DREF_DATE"
                              R_ConductorSource="_conJournalNavigator" />
        </R_ItemLayout>
        <R_ItemLayout xs="1">
            <R_Label></R_Label>
        </R_ItemLayout>
        <R_ItemLayout xs="1">
            <R_Label>Base Rate</R_Label>
        </R_ItemLayout>
        <R_ItemLayout xs="1">
        </R_ItemLayout>
        <R_ItemLayout xs="1">
            <R_Label>Currency Rate</R_Label>
        </R_ItemLayout>
        <R_ItemLayout xs="1">
        </R_ItemLayout>
        <R_ItemLayout xs="1" Class="ms-2">
            <R_Label>Total Debit</R_Label>
        </R_ItemLayout>
        <R_ItemLayout xs="1">
            <R_TextBox bind-value="@_journalVM.Journal.NNTRANS_AMOUNT_D" Enabled="false"></R_TextBox>
        </R_ItemLayout>
    </R_StackLayout>
    <R_StackLayout Row>
        <R_ItemLayout xs="1">
            <R_Label>Document No.</R_Label>
        </R_ItemLayout>
        <R_ItemLayout xs="1">
            <R_TextBox bind-value="@_journalVM.Journal.CDOC_NO" R_EnableAdd></R_TextBox>
        </R_ItemLayout>
        <R_ItemLayout xs="1">
            <R_Label>Doc Date.</R_Label>
        </R_ItemLayout>
        <R_ItemLayout xs="1">
            <R_DateTimePicker @bind-Value="DDOC_DATE"
                              R_ConductorSource="_conJournalNavigator" />
        </R_ItemLayout>
        <R_ItemLayout xs="1" Class="ms-2">
            <R_Label>Local Currency</R_Label>
        </R_ItemLayout>
        <R_ItemLayout xs="1">
            <R_TextBox bind-value="@_journalVM.Journal.NLBASE_RATE" Enabled="ENABLE_NLBASE_RATE"></R_TextBox>
        </R_ItemLayout>
        <R_ItemLayout xs="1">
            <R_TextBox bind-value="@_journalVM.Journal.CCURRENCY_CODE" Enabled="false"></R_TextBox>
        </R_ItemLayout>
        <R_ItemLayout xs="1">
            <R_TextBox bind-value="@_journalVM.Journal.NLCURRENCY_RATE" Enabled="ENABLE_NLCURRENCY_RATE"></R_TextBox>
        </R_ItemLayout>
        <R_ItemLayout xs="1">
            <R_TextBox bind-value="@_journalVM._GSM_COMPANY.CLOCAL_CURRENCY_CODE" Enabled="false"></R_TextBox>
        </R_ItemLayout>
        <R_ItemLayout xs="1" Class="ms-2">
            <R_Label>Total Credit</R_Label>
        </R_ItemLayout>
        <R_ItemLayout xs="1">
            <R_TextBox bind-value="@_journalVM.Journal.NNTRANS_AMOUNT_C" Enabled="false"></R_TextBox>
        </R_ItemLayout>
    </R_StackLayout>
    <R_StackLayout Row>
        <R_ItemLayout xs="1">
            <R_Label>Frequency*</R_Label>
        </R_ItemLayout>
        <R_ItemLayout xs="1">
            <R_NumericTextBox bind-value="@_journalVM.Journal.IFREQUENCY" Min="2" Max="99" Enabled="ENABLE_IFREQUENCY"></R_NumericTextBox>
        </R_ItemLayout>
        <R_ItemLayout xs="1">
            <R_Label>Applied.</R_Label>
        </R_ItemLayout>
        <R_ItemLayout xs="1">
            <R_TextBox bind-value="@_journalVM.Journal.IAPPLIED" Enabled="false"></R_TextBox>
        </R_ItemLayout>
        <R_ItemLayout xs="1" Class="ms-2">
            <R_Label>Base Currency</R_Label>
        </R_ItemLayout>
        <R_ItemLayout xs="3">
            <R_NumericTextBox @bind-Value="_journalVM.Journal.NBBASE_RATE"
                              R_ConductorSource="_conJournalNavigator"
                              R_EnableAdd="true"
                              R_EnableEdit="true"
                              Decimals="2"
                              Min="0" />
        </R_ItemLayout>
        <R_ItemLayout xs="1">
            <R_TextBox @bind-value="@_journalVM.Journal.CCURRENCY_CODE" Enabled="false"></R_TextBox>
        </R_ItemLayout>
        <R_ItemLayout xs="1">
            <R_NumericTextBox @bind-value="@_journalVM.Journal.NBCURRENCY_RATE"
                              R_ConductorSource="_conJournalNavigator"
                              R_EnableAdd="true"
                              R_EnableEdit="true"
                              Decimals="2"
                              Min="0" />
        </R_ItemLayout>
        <R_ItemLayout bind-value="@_journalVM._GSM_COMPANY.CBASE_CURRENCY_CODE" xs="1">
            <R_TextBox></R_TextBox>
        </R_ItemLayout>
    </R_StackLayout>
    <R_StackLayout Row>
        <R_ItemLayout xs="1">
            <R_Label>Interval*</R_Label>
        </R_ItemLayout>
        <R_ItemLayout xs="1">
            <R_NumericTextBox bind-value="@_journalVM.Journal.IPERIOD" Min="2" Max="99" Enabled="ENABLE_IPERIOD"></R_NumericTextBox>
        </R_ItemLayout>
        <R_ItemLayout xs="1" Class="ms-0">
            <R_Label>Month(s)</R_Label>
        </R_ItemLayout>
    </R_StackLayout>
    <R_StackLayout Row>
        <R_ItemLayout xs="1">
            <R_Label>Start Date</R_Label>
        </R_ItemLayout>
        <R_ItemLayout xs="1">
            <R_DateTimePicker onchange="@DSTART_DATE_ONCHANGED" @bind-Value="DSTART_DATE"
                              R_ConductorSource="_conJournalNavigator" R_EnableAdd/>
        </R_ItemLayout>
        <R_ItemLayout Class="ms-2">
            <R_Label>Next Date</R_Label>
        </R_ItemLayout>
        <R_ItemLayout xs="1">
            <R_TextBox bind-value="@_journalVM.Journal.CNEXT_DATE" Enabled="false"></R_TextBox>
        </R_ItemLayout>
        <R_ItemLayout Class="ms-2">
            <R_Label>Last Date</R_Label>
        </R_ItemLayout>
        <R_ItemLayout xs="1">
            <R_TextBox bind-value="@_journalVM.Journal.CLAST_DATE" Enabled="false"></R_TextBox>
        </R_ItemLayout>
        <R_ItemLayout xs="2">
        </R_ItemLayout>
        <R_ItemLayout xs="1">
            <R_Label>Updated By</R_Label>
        </R_ItemLayout>
        <R_ItemLayout xs="1">
            <R_TextBox bind-value="@_journalVM.Journal.CUPDATE_BY" Enabled="false"></R_TextBox>
        </R_ItemLayout>
        <R_ItemLayout xs="2">
            <R_TextBox bind-value="@_journalVM.Journal.DUPDATE_DATE" Enabled="false"></R_TextBox>
        </R_ItemLayout>
    </R_StackLayout>
    <R_StackLayout Row>
        <R_ItemLayout xs="1">
            <R_Label>Description*</R_Label>
        </R_ItemLayout>
        <R_ItemLayout xs="7">
            <R_TextBox bind-value="@_journalVM.Journal.CTRANS_DESC" MaxLength="200" R_EnableAdd></R_TextBox>
        </R_ItemLayout>
        <R_ItemLayout xs="1">
            <R_Label>Created By</R_Label>
        </R_ItemLayout>
        <R_ItemLayout xs="1">
            <R_TextBox bind-value="@_journalVM.Journal.CCREATE_BY" Enabled="false"></R_TextBox>
        </R_ItemLayout>
        <R_ItemLayout xs="2">
            <R_TextBox bind-value="@_journalVM.Journal.DCREATE_DATE" Enabled="ENABLE_DCREATE_DATE"></R_TextBox>
        </R_ItemLayout>
    </R_StackLayout>
    <R_StackLayout Row>
        <R_ItemLayout xs="1">
            <R_AddButton R_Conductor="_conJournalNavigator">Add</R_AddButton>
        </R_ItemLayout>
        <R_ItemLayout xs="1">
            <R_Button>Copy</R_Button>
        </R_ItemLayout>
        <R_ItemLayout xs="1">
            <R_Button>Modify</R_Button>
        </R_ItemLayout>
        <R_ItemLayout xs="1">
            <R_Button>Delete</R_Button>
        </R_ItemLayout>
        <R_ItemLayout xs="1" Class="ms-2">
            <R_Button>Cancel</R_Button>
        </R_ItemLayout>
        <R_ItemLayout xs="1">
            <R_Button>Save</R_Button>
        </R_ItemLayout>
        <R_ItemLayout xs="1" Class="ms-2">
            <R_Button>Print</R_Button>
        </R_ItemLayout>
        <R_ItemLayout xs="1" Class="ms-5">
            <R_Button>Submit</R_Button>
        </R_ItemLayout>
        <R_ItemLayout xs="1">
            <R_Button>Approve</R_Button>
        </R_ItemLayout>
        <R_ItemLayout xs="1">
            <R_Button>Commit</R_Button>
        </R_ItemLayout>
        <R_ItemLayout xs="1">
            <R_Button>Close</R_Button>
        </R_ItemLayout>
    </R_StackLayout>
</R_GroupBox>
<R_Conductor @ref="_conJournalNavigator"
             R_ViewModel="_journalVM"
             R_BeforeAdd="BeforeAddJournal"
             R_ServiceSave="JournalForm_ServiceSave" R_Validation="JournalForm_Validation">
</R_Conductor>

<R_GroupBox Title="Journal Detail">
    <R_Grid Class="mt-3" @ref="@_gridJournalDet"
            DataSource="@_journalVM.JournaDetailList"
            Pageable
            R_ConductorSource="_conJournalDet"
            R_GridType="R_eGridType.Navigator"
            R_ServiceGetListRecord="JournalDetGrid_ServiceGetListRecord"
            Width="1000px">
        <R_GridColumns>
            <R_GridNumericColumn FieldName="@nameof(JournalDetailGridDTO.INO)" HeaderText="No."></R_GridNumericColumn>
            <R_GridTextColumn FieldName="@nameof(JournalDetailGridDTO.CGLACCOUNT_NO)" HeaderText="Account No."></R_GridTextColumn>
            <R_GridTextColumn FieldName="@nameof(JournalDetailGridDTO.CGLACCOUNT_NAME)" HeaderText="Account No"></R_GridTextColumn>
            <R_GridTextColumn FieldName="@nameof(JournalDetailGridDTO.CCENTER_NAME)" HeaderText="Center"></R_GridTextColumn>
            <R_GridTextColumn FieldName="@nameof(JournalDetailGridDTO.CDBCR)" HeaderText="D/C"></R_GridTextColumn>
            <R_GridNumericColumn FieldName="@nameof(JournalDetailGridDTO.NDEBIT)" HeaderText="Debit"></R_GridNumericColumn>
            <R_GridNumericColumn FieldName="@nameof(JournalDetailGridDTO.NCREDIT)" HeaderText="Credit"></R_GridNumericColumn>
            <R_GridTextColumn FieldName="@nameof(JournalDetailGridDTO.CDETAIL_DESC)" HeaderText="Description"></R_GridTextColumn>
            <R_GridNumericColumn FieldName="@nameof(JournalDetailGridDTO.NLDEBIT)" HeaderText="DB (Local)"></R_GridNumericColumn>
            <R_GridNumericColumn FieldName="@nameof(JournalDetailGridDTO.NLCREDIT)" HeaderText="CR (Local)"></R_GridNumericColumn>
            <R_GridNumericColumn FieldName="@nameof(JournalDetailGridDTO.NBDEBIT)" HeaderText="DB (Base)"></R_GridNumericColumn>
            <R_GridNumericColumn FieldName="@nameof(JournalDetailGridDTO.NBCREDIT)" HeaderText="CR (Base)"></R_GridNumericColumn>
        </R_GridColumns>
    </R_Grid>
    <R_Conductor @ref="_conJournalDet"
                 R_ViewModel="_journalVM"
                 R_ServiceGetRecord="JournalDetGrid_ServiceGetRecord"
                 R_Display="JournalDetGrid_Display">
    </R_Conductor>
</R_GroupBox>